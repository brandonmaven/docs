---
title: "Get Context"
api: "POST /voice/api/v1/vapi/get-context"
description: "Get payment session status and result for a Vapi call"
---

Retrieve the status and result of a payment session. Call this after the customer returns from Maven to check whether payment was successful. Look up by `session_id` (preferred) or by `caller` phone number.

This endpoint accepts both flat JSON and Vapi's server-tool envelope format.

## Request Body

At least one of `caller` or `session_id` is required.

<ParamField body="caller" type="string">
  Caller phone number in E.164 format (e.g., `+14155551234`). Returns the most recent session for this number.
</ParamField>

<ParamField body="session_id" type="string">
  Session ID (UUID) returned from the set-context call. Preferred for precise lookup.
</ParamField>

## Response

<ResponseField name="found" type="boolean">
  Whether a matching session was found.
</ResponseField>

<ResponseField name="session_id" type="string">
  Session identifier (UUID).
</ResponseField>

<ResponseField name="status" type="string">
  Session status: `created`, `in_progress`, `completed`, `failed`, or `cancelled`.
</ResponseField>

<ResponseField name="amount" type="number">
  Amount in cents.
</ResponseField>

<ResponseField name="currency" type="string">
  Three-letter currency code (e.g., `usd`).
</ResponseField>

<ResponseField name="caller" type="string">
  Caller phone number.
</ResponseField>

<ResponseField name="card_brand" type="string">
  Card brand (e.g., `visa`, `mastercard`). Present when payment is completed.
</ResponseField>

<ResponseField name="card_last4" type="string">
  Last four digits of the card. Present when payment is completed.
</ResponseField>

<ResponseField name="error_code" type="string">
  Error code if the session failed.
</ResponseField>

<ResponseField name="error_message" type="string">
  Human-readable error message if the session failed.
</ResponseField>

<ResponseField name="error" type="string">
  General error message (e.g., when neither `caller` nor `session_id` is provided).
</ResponseField>

<ResponseField name="provider" type="string">
  Always `vapi`.
</ResponseField>

<RequestExample>

```bash cURL
curl -X POST https://api.trymaven.com/voice/api/v1/vapi/get-context \
  -H "Authorization: Bearer mvn_live_your_api_key" \
  -H "Content-Type: application/json" \
  -d '{
    "session_id": "550e8400-e29b-41d4-a716-446655440000"
  }'
```

```javascript Node.js
const response = await fetch('https://api.trymaven.com/voice/api/v1/vapi/get-context', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer mvn_live_your_api_key',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    session_id: '550e8400-e29b-41d4-a716-446655440000'
  })
});

const result = await response.json();
if (result.found && result.status === 'completed') {
  console.log(`Payment succeeded: ${result.card_brand} ending ${result.card_last4}`);
}
```

```python Python
import requests

response = requests.post(
    'https://api.trymaven.com/voice/api/v1/vapi/get-context',
    headers={'Authorization': 'Bearer mvn_live_your_api_key'},
    json={
        'session_id': '550e8400-e29b-41d4-a716-446655440000'
    }
)

result = response.json()
if result['found'] and result['status'] == 'completed':
    print(f"Payment succeeded: {result['card_brand']} ending {result['card_last4']}")
```

</RequestExample>

<ResponseExample>

```json Response
{
  "found": true,
  "session_id": "550e8400-e29b-41d4-a716-446655440000",
  "status": "completed",
  "amount": 2500,
  "currency": "usd",
  "caller": "+14155551234",
  "card_brand": "visa",
  "card_last4": "4242",
  "error_code": null,
  "error_message": null,
  "error": null,
  "provider": "vapi"
}
```

</ResponseExample>

---

<Accordion title="Vapi Server-Tool Envelope Format">
  When used as a Vapi server tool, Vapi wraps the request in an envelope. Maven automatically extracts the tool call arguments and caller number:

  ```json
  {
    "message": {
      "customer": { "number": "+14155551234" },
      "toolCalls": [
        {
          "id": "call_def456",
          "function": {
            "name": "GetContextFromMaven",
            "arguments": {
              "session_id": "550e8400-e29b-41d4-a716-446655440000"
            }
          }
        }
      ]
    }
  }
  ```

  Maven responds in Vapi's expected format:

  ```json
  {
    "results": [
      {
        "toolCallId": "call_def456",
        "result": {
          "found": true,
          "session_id": "550e8400-e29b-41d4-a716-446655440000",
          "status": "completed",
          "amount": 2500,
          "currency": "usd",
          "caller": "+14155551234",
          "card_brand": "visa",
          "card_last4": "4242",
          "provider": "vapi"
        }
      }
    ]
  }
  ```
</Accordion>
