---
title: Twilio
description: "Step-by-step guide to collecting payments mid-call with Maven and Twilio"
---

Collect payments mid-call by transferring your Twilio customer to Maven, then transferring them back when payment is complete.

<Steps>
  <Step title="Create a Session">

  When your application needs to collect a payment, create a Maven session from your server. The response includes a `phone_number` to transfer the customer to.

  Set `callback` to the phone number where Maven should transfer the customer back after payment.

  <CodeGroup>

  ```python Python
  import requests

  response = requests.post(
      "https://api.trymaven.com/v1/sessions",
      headers={"Authorization": "Bearer mvn_test_xxx"},
      json={
          "project": "my-app",
          "caller": "+14155551234",
          "amount": 2500,
          "mode": "charge",
          "callback": "+18005551234",
          "description": "Order #12345",
          "metadata": {"order_id": "12345"}
      }
  )

  session = response.json()
  maven_number = session["phone_number"]
  ```

  ```bash cURL
  curl -X POST https://api.trymaven.com/v1/sessions \
    -H "Authorization: Bearer mvn_test_xxx" \
    -H "Content-Type: application/json" \
    -d '{
      "project": "my-app",
      "caller": "+14155551234",
      "amount": 2500,
      "mode": "charge",
      "callback": "+18005551234",
      "description": "Order #12345",
      "metadata": { "order_id": "12345" }
    }'
  ```

  </CodeGroup>

  ```json Response
  {
    "session_id": "550e8400-e29b-41d4-a716-446655440000",
    "status": "created",
    "phone_number": "+14085551234",
    "created_at": "2026-02-17T10:30:00Z"
  }
  ```

  </Step>

  <Step title="Transfer the Call">

  Use the `phone_number` from the session response to transfer the customer to Maven. The customer will hear prompts and enter their card details using their phone keypad.

  <CodeGroup>

  ```python Python
  from twilio.twiml.voice_response import VoiceResponse, Dial

  response = VoiceResponse()
  dial = Dial()
  dial.number(maven_number)  # phone_number from Step 1
  response.append(dial)

  print(str(response))
  ```

  ```xml TwiML
  <Response>
    <Dial>
      <Number>+14085551234</Number>
    </Dial>
  </Response>
  ```

  </CodeGroup>

  </Step>

  <Step title="Receive Callback">

  If you set a `callback` number in Step 1, Maven automatically transfers the customer back to that number after payment completes. There is nothing to implement here.

  Your receiving agent or application at the callback number handles the returned call.

  </Step>

  <Step title="Get the Result">

  After the customer transfers back, look up the payment result by the caller's phone number.

  <CodeGroup>

  ```python Python
  import requests

  response = requests.get(
      "https://api.trymaven.com/v1/sessions",
      params={"caller": "+14155551234"},
      headers={"Authorization": "Bearer mvn_test_xxx"}
  )

  session = response.json()
  print(session["status"])  # "payment-success" or "payment-failed"
  ```

  ```bash cURL
  curl "https://api.trymaven.com/v1/sessions?caller=%2B14155551234" \
    -H "Authorization: Bearer mvn_test_xxx"
  ```

  </CodeGroup>

  You can also poll by session ID (`GET /v1/sessions/:id`) until `is_terminal` is `true`.

  <Tip>
    Use the `metadata` field to pass context between your agents. For example, store an order ID or conversation ID so your callback agent knows what the payment was for.
  </Tip>

  </Step>
</Steps>

See [How It Works](/get-started/how-it-works) for the full payment flow and session lifecycle.
